<?xml version="1.0" encoding="UTF-8"?>

<mule xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xmlns:munit="http://www.mulesoft.org/schema/mule/munit" xmlns:munit-tools="http://www.mulesoft.org/schema/mule/munit-tools"
	xmlns="http://www.mulesoft.org/schema/mule/core" xmlns:doc="http://www.mulesoft.org/schema/mule/documentation"
	xsi:schemaLocation="
		http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd
		http://www.mulesoft.org/schema/mule/munit http://www.mulesoft.org/schema/mule/munit/current/mule-munit.xsd
		http://www.mulesoft.org/schema/mule/munit-tools  http://www.mulesoft.org/schema/mule/munit-tools/current/mule-munit-tools.xsd">
	<munit:config name="loan-application-status-x-api-test-suite.xml" />
	<munit:test name="loan-application-status-x-api-test-suite-post:\loan\status\update:application\json:loan-application-status-x-api-configTest" doc:id="b0f2f790-57a6-4a9e-852a-c2091c0c0a66" description="Test">
		<munit:behavior >
			<munit-tools:mock-when doc:name="Papi calling" doc:id="cd039b79-1817-43fe-940a-b3441702f849" processor="http:request">
				<munit-tools:with-attributes >
					<munit-tools:with-attribute whereValue="Calling the Papi" attributeName="doc:name" />
					<munit-tools:with-attribute whereValue="1a0d60ea-1505-4cb4-8992-1b3e9dfa0df3" attributeName="doc:id" />
				</munit-tools:with-attributes>
				<munit-tools:then-return >
					<munit-tools:payload value='#[output application/json&#10;---&#10;{&#10;    "status": "FAILED",&#10;    "reason": "Invalid Transition: cannot move from Under Review to Received"&#10;}]' />
				</munit-tools:then-return>
			</munit-tools:mock-when>
		</munit:behavior>
		<munit:execution >
			<munit:set-event doc:name="inputpayload" doc:id="61526f23-3271-4353-8e9e-5a0f1859e510" >
				<munit:payload value='#[output application/json&#10;---&#10;{&#10;  "loanId": "LN20251004",&#10;  "applicantId": "APP1004",&#10;  "status": "Received",&#10;  "updatedBy": "CreditOfficer02",&#10;  "timestamp": "2025-10-31T12:45:00Z",&#10;  "remarks": "Application rejected"&#10;}]' />
			</munit:set-event>
			<flow-ref doc:name="Flow-ref to post:\loan\status\update:application\json:loan-application-status-x-api-config" doc:id="3b6ce875-5976-4066-a678-45a2d751824b" name="post:\loan\status\update:application\json:loan-application-status-x-api-config"/>
		</munit:execution>
	</munit:test>
	<munit:test name="loan-application-status-x-api-test-suite-loan-application-status-x-api-mainTest" doc:id="5487a24b-4e21-4b31-ab85-95ae77013810" description="Test">
		<munit:behavior >
			<munit-tools:mock-when doc:name="Mock when" doc:id="2bb5e16a-7c7b-46ee-99c0-6c3b5727b76d" processor="apikit:router">
				<munit-tools:with-attributes >
					<munit-tools:with-attribute whereValue="loan-application-status-x-api-config" attributeName="config-ref" />
					<munit-tools:with-attribute whereValue="APIkit Router." attributeName="doc:name" />
				</munit-tools:with-attributes>
				<munit-tools:then-return >
					<munit-tools:error typeId="APIKIT:NOT_FOUND" />
				</munit-tools:then-return>
			</munit-tools:mock-when>
		</munit:behavior>
		<munit:execution >
			<munit:set-event doc:name="inputpayload" doc:id="43e5ab7b-c7fe-4945-babf-8d5adb06d7f7">
				<munit:payload value='#[output application/json&#10;---&#10;{&#10;  "loanId": "LN20251004",&#10;  "applicantId": "APP1004",&#10;  "status": "Received",&#10;  "updatedBy": "CreditOfficer02",&#10;  "timestamp": "2025-10-31T12:45:00Z",&#10;  "remarks": "Application rejected"&#10;}]' />
			</munit:set-event>
			<flow-ref doc:name="Flow-ref to loan-application-status-x-api-main" doc:id="2a746659-5a33-4a7f-aeb1-9f333e7b6a7d" name="loan-application-status-x-api-main"/>
		</munit:execution>
	</munit:test>
	<munit:test name="loan-application-status-x-api-test-suite-post:\loan\status\update:application\json:loan-application-status-x-api-configTest1" doc:id="9524e4b8-e5a8-4de4-9c68-7e27bbcdbd5c" description="Test" >
		<munit:behavior >
			<munit-tools:mock-when doc:name="Papi calling" doc:id="f01f2abf-6e61-45e2-bfb5-8ad344a393cd" processor="http:request" >
				<munit-tools:with-attributes >
					<munit-tools:with-attribute whereValue="Calling the Papi" attributeName="doc:name" />
					<munit-tools:with-attribute whereValue="1a0d60ea-1505-4cb4-8992-1b3e9dfa0df3" attributeName="doc:id" />
				</munit-tools:with-attributes>
				<munit-tools:then-return >
					<munit-tools:payload value='#[output application/json&#10;---&#10;{&#10;    "status": "FAILED",&#10;    "reason": "Invalid Transition: cannot move from Under Review to Received"&#10;}]' />
					<munit-tools:error typeId="ANY" />
				</munit-tools:then-return>
			</munit-tools:mock-when>
		</munit:behavior>
		<munit:execution >
			<munit:set-event doc:name="inputpayload" doc:id="865157af-d5f5-4c7b-9a54-14d281af3498" >
				<munit:payload value='#[output application/json&#10;---&#10;{&#10;  "loanId": "LN20251004",&#10;  "applicantId": "APP1004",&#10;  "status": "Received",&#10;  "updatedBy": "CreditOfficer02",&#10;  "timestamp": "2025-10-31T12:45:00Z",&#10;  "remarks": "Application rejected"&#10;}]' />
			</munit:set-event>
			<flow-ref doc:name="Flow-ref to post:\loan\status\update:application\json:loan-application-status-x-api-config" doc:id="a41c2acc-83c3-4207-bc51-6504988c6ef2" name="post:\loan\status\update:application\json:loan-application-status-x-api-config" />
		</munit:execution>
	</munit:test>


</mule>
